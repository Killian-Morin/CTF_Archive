# Clue / Information
The systems analyst has detected that an employee is a spy and that he has sent information to another spy from a bank computer, to discover what information he sent has analyzed the computer's network traffic. Note: Parse the capture file user_bank.pcapng

# Resolution
some data that I thought were interesting when opening the file in Wireshark

POST /libreria/php/get-libro.php HTTP/1.1
Cookie: PHPSESSID=h0b4k2eii5pgj0g898m361nesl
incoming_id=340066300

------WebKitFormBoundary4NvyI6DimeVQg59j
Content-Disposition: form-data; name="incoming_id"

340066300
------WebKitFormBoundary4NvyI6DimeVQg59j
Content-Disposition: form-data; name="message"

64696b7d5:58797d6:695b7c5:584:7e5:59637g6:6962787343467d5:596387738:4578646889845:58577c6b54538175545341738:53857664538472695f415d7:5353737f7c787344637g6b695:787444677f6b43678b75587d87737f5e3g
------WebKitFormBoundary4NvyI6DimeVQg59j--

61586381757:537b7358578b748b417:6:43797975545381737e5f8773687d866b8:5:3c547:52785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:54527861587d856b8:538b747e5e4:5:7f537g74544:817368577f6b695e875e656:425e7b6:435e556:8b5g595f416:686b7e5d6857436:696379747:4688737e747:5:5857847555417:5:7b455c5:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452496b587d435:585f846:695f8b61645b7c6b6963797268898b5:7b455c5:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452786159523c68684:425:5842816b4379415:585784744349786b68468273447c786758797d5:5675877358637d737:5355734342886:695f8b5:585b465:57537g726889817454536275688984736857865d7:535b75595e787558797d5:586b81747f5f415:585b8773438478726845787558797d5:567981748:53566:695b835:5642797558678:72685784748:5341747e7d84734375465:5857866b54537e6b68574175695b7d748:53795:595379747e5784735867845:59678672696b7d747f5f7d5:597581755878787368577f72685f797354537b747e67797559678:6b695e786:68467c5:5856786b445b8174595381737e747874446387747f7d847268467d5d7b88877455455c5:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452495d436381757b455c5:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452495d436381757b454e

------WebKitFormBoundaryoEcCuSxvBKhbHqXE
Content-Disposition: form-data; name="incoming_id"

340066300
------WebKitFormBoundaryoEcCuSxvBKhbHqXE
Content-Disposition: form-data; name="message"

6758797d744366786:6889845:595f877568467c5:586b79737f6379744463816:8:45786358497876684:425:587979757e66786:6846465:584287747e6678747e677b734342856b68467c6:6963817343468b61884e4e
------WebKitFormBoundaryoEcCuSxvBKhbHqXE--

61586381757:537b7358578b748b417:6:43797975545381737e5f8773687d866b8:5:3c547:52785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:54527861587d856b8:538b747e5e4:5:7f537g74544:817368577f6b695e875e656:425e7b6:435e556:8b5g595f416:686b7e5d6857436:696379747:4688737e747:5:5857847555417:5:7b455c5:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452496b587d435:585f846:695f8b61645b7c6b6963797268898b5:7b455c5:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452786159523c6868678b5d5453467344667873687d7f725962786:68898b738:53847268857d5:57637g6b64535g6:68427d5:584:7e5:59637g6b6453697268467c5:585b465:57537975595b816:438478667e4:4172586b4274445e865:567d41748:53795:586b7974435f81737e57417268467f5:595f4173445b465:58577:734467415:58567876684:42737e747874595b876b587d7f766453866:68427d6b54535d757e4:41725866845:59757g738:53866:695b8:6:69637d748:537g72695e7873587d7e6b64537e726889846b68627875437d41725453856:6875816:8:88787369678b72685e845:5857866b5453796b596b7d737f6342747e678b5d7b88877455455c5:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452495d436381757b455c5:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452785:5452495d436381757b454e

------WebKitFormBoundarywjgSyxy6hkkR8VC9
Content-Disposition: form-data; name="incoming_id"

340066300
------WebKitFormBoundarywjgSyxy6hkkR8VC9
Content-Disposition: form-data; name="message"

675879797554538b734467866b595e78747e6779735889465:587587734362865:565786766453877558797d747:537:73434:83748:53467344667875587981737e84786464538b72584:4273586278747e67796b55494e
------WebKitFormBoundarywjgSyxy6hkkR8VC9--

# writeup
1. Open pcap file in wireshark
2. Extract libro.js from HTTP objects -> we see how the messages are encrypted (It was an HTTP webpage (PHP), there had to be a way to encrypt and decrypt in the front)
3. Write the code to reverse operations
4. Download the insert-libro.php files and decrypt the strings
5. Keep trying the different files until you get the flag.

Decryption script:
```python
import base64
import sys

def decrypt(encrypted_string):
    decoded_string = ''

    if len(encrypted_string) > 0:
        # Reverse ASCII shift by 1
        hex_str = ''.join([chr(ord(char) - 1) for char in encrypted_string])

        # Convert Hexadecimal to Base64
        base64_str = ''.join([chr(int(hex_str[i:i+2], 16)) for i in range(0, len(hex_str), 2)])

        # Decode Base64
        decoded_string = base64.b64decode(base64_str).decode('utf-8')

    return decoded_string

if __name__ == "__main__":
    # Pass encrypted string as arg
    if len(sys.argv) != 2:
        print("Use: python script.py <encrypted_string>")
    else:
        encrypted_string = sys.argv[1]
        print("Decrypted text: ", decrypt(encrypted_string))
```
